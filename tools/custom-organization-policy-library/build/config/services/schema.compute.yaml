#@ load("@ytt:overlay", "overlay")
#@data/values-schema
---
#@overlay/match missing_ok=True
compute:
  computeAllowedInstanceMachineTypes:
    #@schema/validation one_of=["default", "skip", "include"]
    generation: "default"
    params:
      #@schema/validation min_len=1
      regex: '^(allow|deny)-(ingress|egress)-[a-zA-Z0-9-]*-(dev|uat|prd)$'
    bundles:
      pci-dss: true
      cis: false
  computeAllowedInstanceLabels:
    #@schema/validation one_of=["default", "skip", "include"]
    generation: "default"
    bundles:
      pci-dss: false
      cis: true